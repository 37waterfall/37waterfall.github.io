<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/icon16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/favicon32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="React项目学习实践">
<meta property="og:type" content="article">
<meta property="og:title" content="React实际案例">
<meta property="og:url" content="http://example.com/2022/02/02/React%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B/index.html">
<meta property="og:site_name" content="LJY_BLOG">
<meta property="og:description" content="React项目学习实践">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s4.ax1x.com/2022/02/03/HVpVRP.jpg">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/e5e14061e681cfc8.jpg">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/fa97724212c5b361.jpg">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/9415caec77668c47.jpg">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/1cd8f777d5d14592.jpg">
<meta property="article:published_time" content="2022-02-02T01:11:12.000Z">
<meta property="article:modified_time" content="2022-02-05T03:29:11.107Z">
<meta property="article:author" content="LJY">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s4.ax1x.com/2022/02/03/HVpVRP.jpg"><title>React实际案例 | LJY_BLOG</title><link ref="canonical" href="http://example.com/2022/02/02/React%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">主页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">档案</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/reading/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">阅读</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">LJY_BLOG</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><div class="sticky-top" data-popover="Sticky" data-popover-pos="up"><span class="sticky-top__icon"><i class="fas fa-thumbtack"></i></span></div><h1 class="post-title">React实际案例</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">创建</span><span class="post-meta-item__value">2022-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新</span><span class="post-meta-item__value">2022-02-05</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">阅读时间</span><span class="post-meta-item__value">47m</span></span></div></header><div class="post-body"><p>React项目学习实践</p>
<span id="more"></span>


        <h1 id="build-your-own-react">
          <a href="#build-your-own-react" class="heading-link"><i class="fas fa-link"></i></a><a href="#build-your-own-react" class="headerlink" title="build-your-own-react"></a>build-your-own-react</h1>
      <p>第一个react的学习项目，构建一个最小化的react。</p>
<p>学习学习react的思想。</p>
<p>链接<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://pomb.us/build-your-own-react/">build-your-own-react</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<hr>
<p>先记录下遇到的问题。。</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://t.zoukankan.com/rubylouvre-p-6767769.html">直接在浏览器运行jsx及高版本的js代码</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://juejin.cn/post/6884968140892176397">译】build your own react - 知识搬运工</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>运行jsx，要用bable，不然报错。<br>添加以下代码。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src="https://unpkg.com/babel-standalone@6/babel.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type="text/babel"&gt;</span><br><span class="line"></span><br><span class="line">//出错的位置。</span><br><span class="line">	/** @jsx Didact.createElement */</span><br><span class="line">	const element = ( &lt;</span><br><span class="line">		div style = "background: salmon" &gt;</span><br><span class="line">		&lt;</span><br><span class="line">		h1 &gt; Hello World &lt; /h1&gt; &lt;</span><br><span class="line">		h2 style = "text-align:right" &gt; from Didact &lt; /h2&gt; </span><br><span class="line">		</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	);</span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="开始">
          <a href="#开始" class="heading-link"><i class="fas fa-link"></i></a><a href="#开始" class="headerlink" title="开始"></a>开始</h2>
      <p>学习内容大纲</p>
<ul>
<li>I: The createElement Function // 创建节点，JSX</li>
<li>II: The render Function // 写入页面，添加元素</li>
<li>III: Concurrent Mode // 处理递归</li>
<li>IV: Fibers // 建立Fiber树</li>
<li>V: Render and Commit Phases // 处理删除更新节点</li>
<li>VI: Reconciliation // 比较</li>
<li>VII: Function Components // 添加的是对函数组件的支持。</li>
<li>VIII: Hooks // 跨组件传递信息</li>
</ul>

        <h2 id="1-The-createElement-Function">
          <a href="#1-The-createElement-Function" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-The-createElement-Function" class="headerlink" title="1.The createElement Function"></a>1.The createElement Function</h2>
      <figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">** @jsx Didact.createElement */</span><br><span class="line">const element = ( // 使用bable就可以运行了。</span><br><span class="line">  &lt;div id="foo"&gt;</span><br><span class="line">    &lt;a&gt;bar&lt;/a&gt;</span><br><span class="line">    &lt;b /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="2-The-render-Function">
          <a href="#2-The-render-Function" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-The-render-Function" class="headerlink" title="2.The render Function"></a>2.The render Function</h2>
      <p>添加元素</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">function createElement(type, props, ...children) {</span><br><span class="line">  return {</span><br><span class="line">    type,</span><br><span class="line">    props: {</span><br><span class="line">      ...props,</span><br><span class="line">      children: children.map(child =&gt;</span><br><span class="line">        typeof child === "object"</span><br><span class="line">          ? child</span><br><span class="line">          : createTextElement(child) // 创建一个文本节点。</span><br><span class="line">      ),</span><br><span class="line">    },</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">function createTextElement(text) {</span><br><span class="line">  return {</span><br><span class="line">    type: "TEXT_ELEMENT", // 标记。</span><br><span class="line">		//这几乎就像字符串有了 props: { nodeValue: “ hello”}。</span><br><span class="line">    props: {</span><br><span class="line">      nodeValue: text,</span><br><span class="line">      children: [],</span><br><span class="line">    },</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">function render(element, container) {</span><br><span class="line">	// 创建节点</span><br><span class="line">  const dom =</span><br><span class="line">    element.type == "TEXT_ELEMENT"</span><br><span class="line">      ? document.createTextNode("") // 创建文字节点，</span><br><span class="line">      : document.createElement(element.type)</span><br><span class="line">​</span><br><span class="line">  const isProperty = key =&gt; key !== "children"</span><br><span class="line">	</span><br><span class="line">  Object.keys(element.props)</span><br><span class="line">    .filter(isProperty)</span><br><span class="line">    .forEach(name =&gt; {</span><br><span class="line">      dom[name] = element.props[name]</span><br><span class="line">    })</span><br><span class="line">​</span><br><span class="line">  element.props.children.forEach(child =&gt;</span><br><span class="line">	</span><br><span class="line">	// 如果数据量很大，会卡顿。需要修改。</span><br><span class="line">    render(child, dom) // 使用递归，添加节点。</span><br><span class="line">  )</span><br><span class="line">​	</span><br><span class="line">// 写入页面。</span><br><span class="line">  container.appendChild(dom)</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">// </span><br><span class="line">const Didact = {</span><br><span class="line">  createElement,</span><br><span class="line">  render,</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">/** @jsx Didact.createElement */</span><br><span class="line">const element = (</span><br><span class="line">  &lt;div id="foo"&gt;</span><br><span class="line">    &lt;a&gt;bar&lt;/a&gt;</span><br><span class="line">    &lt;b /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">)</span><br><span class="line">const container = document.getElementById("root")</span><br><span class="line"></span><br><span class="line">// 调用render</span><br><span class="line">Didact.render(element, container)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="3-Concurrent-Mode">
          <a href="#3-Concurrent-Mode" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Concurrent-Mode" class="headerlink" title="3. Concurrent Mode"></a>3. Concurrent Mode</h2>
      <p>解决递归数据很大的问题，我们将把工作分解成小单元，在完成每个单元之后，<br>如果还有其他任务需要完成，我们将让浏览器中断渲染。</p>
<p>使用 requestedlecallback<br>可以把 requestedlecallback 想象成一个 setTimeout<br>浏览器不会告诉它什么时候运行，而是在主线程空闲时运行回调。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">let nextUnitOfWork = null</span><br><span class="line">​</span><br><span class="line">function workLoop(deadline) {</span><br><span class="line">  let shouldYield = false</span><br><span class="line">  while (nextUnitOfWork &amp;&amp; !shouldYield) {</span><br><span class="line">    nextUnitOfWork = performUnitOfWork(</span><br><span class="line">      nextUnitOfWork</span><br><span class="line">    )</span><br><span class="line">    shouldYield = deadline.timeRemaining() &lt; 1</span><br><span class="line">  }</span><br><span class="line">	</span><br><span class="line">	//React 不再使用 requestedlecallback 了。现在它使用了调度程序包。但是对于这个用例来说，它在概念上是相同的。</span><br><span class="line">	</span><br><span class="line">	//Requestedlecallback 还为我们提供了一个截止日期参数。我们可以用它来检查我们还有多少时间，直到浏览器需要再次控制。</span><br><span class="line">  requestIdleCallback(workLoop) // 递归,在主线程空闲时运行回调。</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">requestIdleCallback(workLoop) // 调用。</span><br><span class="line">​</span><br><span class="line">function performUnitOfWork(nextUnitOfWork) {</span><br><span class="line">  // TODO</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="4-Fibers">
          <a href="#4-Fibers" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Fibers" class="headerlink" title="4. Fibers"></a>4. Fibers</h2>
      <p><img src="https://s4.ax1x.com/2022/02/03/HVpVRP.jpg" alt="图片"></p>
<p>Fibers tree需要做的内容。</p>
<ol>
<li>add the element to the DOM</li>
<li>create the fibers for the element’s children</li>
<li>select the next unit of work</li>
</ol>
<p>目的之一。<br>找到前后的节点。<br>One of the goals of this data structure is to make it easy to <strong>find</strong> the next unit of work.<br>That’s why each fiber has a link to its first child, its next sibling and its parent.</p>
<p>If the fiber doesn’t have a child, we use the sibling as the next unit of work.</p>
<p>有child 找child，<br>没有child， 找sibling<br>没有sibling， 找uncle</p>
<p>直到找到根<br>如果我们已经到达了根目录，这意味着我们已经完成了渲染的所有工作。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在 render 函数中，我们将 nextUnitOfWork 设置为光纤树的根。</span><br><span class="line">function render(element, container) {</span><br><span class="line">  nextUnitOfWork = {</span><br><span class="line">    dom: container,</span><br><span class="line">    props: {</span><br><span class="line">      children: [element],</span><br><span class="line">    },</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">let nextUnitOfWork = null</span><br></pre></td></tr></tbody></table></div></figure>


<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">然后，当浏览器准备就绪，它将调用我们的 workLoop，我们将开始处理 root。</span><br><span class="line">function workLoop(deadline) {</span><br><span class="line">  let shouldYield = false</span><br><span class="line">  while (nextUnitOfWork &amp;&amp; !shouldYield) {</span><br><span class="line">    nextUnitOfWork = performUnitOfWork(</span><br><span class="line">      nextUnitOfWork</span><br><span class="line">    )</span><br><span class="line">    shouldYield = deadline.timeRemaining() &lt; 1</span><br><span class="line">  }</span><br><span class="line">  requestIdleCallback(workLoop)</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">requestIdleCallback(workLoop)</span><br><span class="line">​</span><br><span class="line">function performUnitOfWork(fiber) {</span><br><span class="line">  // TODO add dom node</span><br><span class="line">  // TODO create new fibers</span><br><span class="line">  // TODO return next unit of work</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure>


<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">function performUnitOfWork(fiber) {</span><br><span class="line">	</span><br><span class="line">	// 创建节点</span><br><span class="line">  if (!fiber.dom) {</span><br><span class="line">    fiber.dom = createDom(fiber)</span><br><span class="line">  }</span><br><span class="line">​	</span><br><span class="line">// 添加节点</span><br><span class="line">  if (fiber.parent) {</span><br><span class="line">    fiber.parent.dom.appendChild(fiber.dom)//首先，我们创建一个新节点并将其附加到 DOM。</span><br><span class="line">  }</span><br><span class="line">​</span><br><span class="line">// 然后我们为每个孩子创造一种新的纤维。</span><br><span class="line">  const elements = fiber.props.children</span><br><span class="line">  let index = 0</span><br><span class="line">  let prevSibling = null</span><br><span class="line">​</span><br><span class="line">  while (index &lt; elements.length) {</span><br><span class="line">    const element = elements[index]</span><br><span class="line">​</span><br><span class="line">    const newFiber = { </span><br><span class="line">      type: element.type,</span><br><span class="line">      props: element.props,</span><br><span class="line">      parent: fiber,</span><br><span class="line">      dom: null,</span><br><span class="line">    }</span><br><span class="line">​</span><br><span class="line">    if (index === 0) { //我们把它添加到纤维树中，根据它是不是第一个孩子的不同，它可以是孩子也可以是兄弟姐妹。</span><br><span class="line">      fiber.child = newFiber</span><br><span class="line">    } else {</span><br><span class="line">      prevSibling.sibling = newFiber</span><br><span class="line">    }</span><br><span class="line">​</span><br><span class="line">    prevSibling = newFiber</span><br><span class="line">    index++</span><br><span class="line">  }</span><br><span class="line">​</span><br><span class="line">	//最后，我们寻找下一个工作单元。我们首先尝试与孩子，然后与兄弟姐妹，然后与叔叔，等等。</span><br><span class="line">  if (fiber.child) {</span><br><span class="line">    return fiber.child // 有，就返回。</span><br><span class="line">  }</span><br><span class="line">	</span><br><span class="line">  let nextFiber = fiber</span><br><span class="line">  while (nextFiber) {</span><br><span class="line">    if (nextFiber.sibling) {</span><br><span class="line">      return nextFiber.sibling // 返回下一个兄弟节点。</span><br><span class="line">    }</span><br><span class="line">    nextFiber = nextFiber.parent</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="5-Render-and-Commit-Phases">
          <a href="#5-Render-and-Commit-Phases" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Render-and-Commit-Phases" class="headerlink" title="5. Render and Commit Phases"></a>5. Render and Commit Phases</h2>
      <p>解决问题。<br>如果浏览器渲染被中断，显示信息不完整。</p>
<blockquote>
<p>We are adding a new node to the DOM each time we work on an element.<br>And, remember, the browser could interrupt our work before we finish rendering the whole tree.<br>In that case, the user will see an incomplete UI. And we don’t want that.</p>
</blockquote>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">function commitRoot() {</span><br><span class="line">  // TODO add nodes to dom</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">function render(element, container) {</span><br><span class="line">  wipRoot = {</span><br><span class="line">    dom: container,</span><br><span class="line">    props: {</span><br><span class="line">      children: [element],</span><br><span class="line">    },</span><br><span class="line">  }</span><br><span class="line">  nextUnitOfWork = wipRoot</span><br><span class="line">}</span><br><span class="line">​</span><br><span class="line">let nextUnitOfWork = null</span><br><span class="line">let wipRoot = null</span><br><span class="line">​</span><br><span class="line">function workLoop(deadline) {</span><br><span class="line">  let shouldYield = false</span><br><span class="line">  while (nextUnitOfWork &amp;&amp; !shouldYield) {</span><br><span class="line">    nextUnitOfWork = performUnitOfWork(</span><br><span class="line">      nextUnitOfWork</span><br><span class="line">    )</span><br><span class="line">    shouldYield = deadline.timeRemaining() &lt; 1</span><br><span class="line">  }</span><br><span class="line">​</span><br><span class="line">  if (!nextUnitOfWork &amp;&amp; wipRoot) {</span><br><span class="line">    commitRoot()</span><br><span class="line">  }</span><br><span class="line">​</span><br><span class="line">  requestIdleCallback(workLoop)</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="6-Reconciliation">
          <a href="#6-Reconciliation" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-Reconciliation" class="headerlink" title="6. Reconciliation"></a>6. Reconciliation</h2>
      <p>比较节点, 处理更新和删除节点的操作</p>
<blockquote>
<p>we need to compare the elements we receive on the render function to the last fiber tree<br>we committed to the DOM.</p>
</blockquote>
<p>思考：分出了fiber，比较，减少Dom操作？<br>通过type比较</p>
<p>To compare them we use the type:</p>
<ol>
<li><p>if the old fiber and the new element have the <strong>same type</strong>, we can keep the DOM node and just update it with the new props</p>
</li>
<li><p>if the type is different and there is <strong>a new element</strong>, it means we need to create a new DOM node</p>
</li>
<li><p>and if the types are different and there is <strong>an old fiber</strong>, we need to remove the old node</p>
</li>
</ol>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const sameType =</span><br><span class="line">  oldFiber &amp;&amp;</span><br><span class="line">  element &amp;&amp;</span><br><span class="line">  element.type == oldFiber.type</span><br><span class="line"> </span><br><span class="line"> //if the old fiber and the new element have the same type, we can keep the DOM node </span><br><span class="line"> //and just update it with the new props</span><br><span class="line"> // update</span><br><span class="line">if (sameType) {</span><br><span class="line">  // TODO update the node</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">//if the type is different and there is a new element, it means we need to create a new DOM node</span><br><span class="line">// create</span><br><span class="line">if (element &amp;&amp; !sameType) {</span><br><span class="line">  // TODO add this node</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">//and if the types are different and there is an old fiber, we need to remove the old node</span><br><span class="line">// remove</span><br><span class="line">if (oldFiber &amp;&amp; !sameType) {</span><br><span class="line">  // TODO delete the oldFiber's node</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure>


<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">const sameType =</span><br><span class="line">      oldFiber &amp;&amp;</span><br><span class="line">      element &amp;&amp;</span><br><span class="line">      element.type == oldFiber.type</span><br><span class="line">​</span><br><span class="line">    if (sameType) {</span><br><span class="line">      newFiber = {</span><br><span class="line">        type: oldFiber.type,</span><br><span class="line">        props: element.props,</span><br><span class="line">        dom: oldFiber.dom,</span><br><span class="line">        parent: wipFiber,</span><br><span class="line">        alternate: oldFiber,</span><br><span class="line">        effectTag: "UPDATE", // 添加的新属性</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	 if (element &amp;&amp; !sameType) {</span><br><span class="line">	      newFiber = {</span><br><span class="line">	        type: element.type,</span><br><span class="line">	        props: element.props,</span><br><span class="line">	        dom: null,</span><br><span class="line">	        parent: wipFiber,</span><br><span class="line">	        alternate: null,</span><br><span class="line">	        effectTag: "PLACEMENT",//用 PLACEMENT effect 标签标记新的光纤。</span><br><span class="line">	      }</span><br><span class="line">	    }</span><br><span class="line">			</span><br><span class="line">		if (oldFiber &amp;&amp; !sameType) {</span><br><span class="line">		//对于需要删除节点的情况，我们没有新的光纤，所以我们将 effect 标签添加到旧的光纤中。</span><br><span class="line">		//但是当我们将纤维树提交给 DOM 时，我们从正在进行的工作根中提交它，因为它没有旧的纤维。</span><br><span class="line">		//所以我们需要一个数组来跟踪我们想要删除的节点。</span><br><span class="line">		     oldFiber.effectTag = "DELETION"</span><br><span class="line">		     deletions.push(oldFiber)</span><br><span class="line">		   }</span><br></pre></td></tr></tbody></table></div></figure>

<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://codesandbox.io/s/didact-6-96533">React测试在线链接</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="7-Function-Components">
          <a href="#7-Function-Components" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-Function-Components" class="headerlink" title="7. Function Components"></a>7. Function Components</h2>
      <p>添加的是对函数组件的支持。<br>通过函数返回，创建JSX</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/** @jsx Didact.createElement */</span><br><span class="line">function App(props) {</span><br><span class="line">  return &lt;h1&gt;Hi {props.name}&lt;/h1&gt;</span><br><span class="line">}</span><br><span class="line">const element = &lt;App name="foo" /&gt;</span><br><span class="line">const container = document.getElementById("root")</span><br><span class="line">Didact.render(element, container)</span><br></pre></td></tr></tbody></table></div></figure>



        <h2 id="8-Hooks">
          <a href="#8-Hooks" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-Hooks" class="headerlink" title="8. Hooks"></a>8. Hooks</h2>
      <p>使用 Didact.useState 来获取和更新计数器值。</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://codesandbox.io/s/didact-8-21ost">最终版本</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>用React 的思想，实现一个计数器，敲了一遍。</p>

        <h2 id="总结">
          <a href="#总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#总结" class="headerlink" title="总结"></a>总结</h2>
      <p>第一次实现思考源码是怎么实现的，感谢作者的教程，还需要多理解理解。</p>
<p>目前学习的是组件渲染，交互，数据传递。</p>
<p>思考方式：<br><strong>遍历：</strong><br>用于过滤数据，查找信息，递归渲染节点。</p>
<p><strong>判断：</strong><br>用 &amp;&amp;、 ！==、typeof、下标等方式，赋值信息。</p>
<p><strong>选择：</strong><br>使用字符串，标记信息，通过字符串的处理，找到当前需要的信息</p>
<p>函数：<br>createElement() // 创建dom<br>createTextElement()</p>
<p>createDom() // 添加fiber</p>
<p>isEvent() // 判断信息<br>isProperty()<br>isNew()<br>isGone()</p>
<p>updateDom() // 处理dom<br>commitRoot()<br>commitWork()<br>commitDeletion()</p>
<p>render() // 起始</p>
<p>workLoop() // 循环</p>
<p>performUnitOfWork() // 往下查找。</p>
<p>updateFunctionComponent() // 调用reconcileChildren</p>
<p>useState() // return [hook.state, setState];</p>
<p>updateHostComponent()</p>
<p>reconcileChildren() // 处理更新，删除，添加。判断条件oldFiber &amp;&amp; !sameType</p>
<p>Counter() // 函数式组件， 怎么解出来的？</p>
<p>变量：</p>
<p>Didact - 3个方法createElement、render、useState</p>
<p>element // 接收函数式组件<br>container // 存放的容器 - root</p>
<p>state //<br>setState</p>
<p>type // 定义的数据结构内容。<br>props<br>children</p>
<p>fiber // 数据结构，用于查找</p>
<p>dom<br>prevProps<br>nextProps</p>
<p>currentRoot<br>wipRoot // 数据结构，</p>
<p>domParentFiber // </p>
<p>effectTag // 删除、更新、添加的标记</p>
<p>nextUnitOfWork // 查找<br>shouldYield // 时间判断<br>currentRoot</p>
<p>deletions // 删除标记</p>
<p>isFunctionComponent</p>
<p>nextFiber</p>
<p>wipFiber<br>hookIndex</p>
<p>alternate // 比较信息</p>
<p>actions // </p>

        <h1 id="项目01-JD首页">
          <a href="#项目01-JD首页" class="heading-link"><i class="fas fa-link"></i></a><a href="#项目01-JD首页" class="headerlink" title="项目01-JD首页"></a>项目01-JD首页</h1>
      <p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://github.com/Cathy0807/react">案例源码</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>第一步：先能运行！ - 可行！</p>
<p>技术栈：<br>Reactjs &amp;&amp; ES6 &amp;&amp; webpack<br>基于文件系统的Node.js服务端</p>

        <h2 id="遇到问题：">
          <a href="#遇到问题：" class="heading-link"><i class="fas fa-link"></i></a><a href="#遇到问题：" class="headerlink" title="遇到问题："></a>遇到问题：</h2>
      <p>npm install，需要再安装一下缺失文件，跟着提示来。</p>
<p>JSX怎么写注释?<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/xutongbao/p/9924769.html">JSX添加注释</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>jsonp的作用?</p>
<blockquote>
<p>JSONP（JSON with Padding）是一种常用的跨域手段，但只支持JS脚本和JSON格式的数据。<br>顾名思义，JSONP是利用JSON作为垫片，从而实现跨域请求的一种技术手段。其基本原理是利用HTML的<br><code>&lt;script&gt;</code>标签天生可以跨域这一特点，用其加载另一个域的JSON数据，加载完成后会自动运行一个回调函数通知调用者。<br>此过程需要另一个域的服务端支持，所以这种方式实现的跨域并不是任意的。</p>
</blockquote>
<p>同源: 协议+域名或地址+端口</p>

        <h2 id="整体思路">
          <a href="#整体思路" class="heading-link"><i class="fas fa-link"></i></a><a href="#整体思路" class="headerlink" title="整体思路"></a>整体思路</h2>
      <p>React构建页面<br>Webpack，打包数据，压缩代码，构建发布文件<br>Node，构建服务器，可以用jsonp访问。</p>
<p>组件文件 - 小写命名 - search.jsx<br>组件引用 - 开头字母大写 - <search></search></p>
<blockquote>
<p>其他跳转页面直接用官网的。。。</p>
</blockquote>

        <h2 id="页面布局">
          <a href="#页面布局" class="heading-link"><i class="fas fa-link"></i></a><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h2>
      <p>整体布局划分<br><img src="https://s3.bmp.ovh/imgs/2022/02/e5e14061e681cfc8.jpg" alt="01"><br><img src="https://s3.bmp.ovh/imgs/2022/02/fa97724212c5b361.jpg" alt="02"></p>
<p>使用React的函数式组件，构建页面。<br>source 用于jsonp 获取信息。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&lt;Search /&gt;</span><br><span class="line">		&lt;Header source="http://localhost:3000/data/swiper" /&gt;</span><br><span class="line">		&lt;Otherapp source="http://localhost:3000/data/otherapp" /&gt;</span><br><span class="line">		&lt;Spike source="http://localhost:3000/data/spike" /&gt;</span><br><span class="line">		&lt;More source="http://localhost:3000/data/more" /&gt;</span><br><span class="line">		&lt;Like source="http://localhost:3000/data/like" /&gt;</span><br><span class="line">	&lt;/div&gt;, </span><br><span class="line">	document.querySelector("#myApp")</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></div></figure>


        <h2 id="组件编写">
          <a href="#组件编写" class="heading-link"><i class="fas fa-link"></i></a><a href="#组件编写" class="headerlink" title="组件编写"></a>组件编写</h2>
      <p>编写组件路径<br>app - components</p>
<p>使用公共css，放在lib文件里面，建立公共样式</p>
<p>组件使用jsx，+ 对应的css样式</p>

        <h3 id="search-jsx">
          <a href="#search-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#search-jsx" class="headerlink" title="search.jsx"></a>search.jsx</h3>
      <p>主体结构再render() 里面。<br>getInitialState() - 用于初始化，现已启用，都放在constructor<br>componentDidMount() - 生命周期函数，加载完dom，运行。这里设置了滚动固定search组件</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount: function() {</span><br><span class="line">	// 滚动固定search组件！+ 改变颜色和透明度</span><br><span class="line">	window.onscroll = (event) =&gt; {</span><br><span class="line">		let realHeight = document.documentElement.scrollTop || document.body.scrollTop;</span><br><span class="line">		let optatic = 0.8 * (realHeight/142);</span><br><span class="line">		if(optatic &lt;= 0.8 ) {</span><br><span class="line">			this.setState({</span><br><span class="line">				bg: `rgba(234, 44, 44, ${optatic})`,</span><br><span class="line">			})</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></div></figure>



        <h3 id="header-jsx">
          <a href="#header-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#header-jsx" class="headerlink" title="header.jsx"></a>header.jsx</h3>
      <p>引入资源</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require("./header.css");</span><br><span class="line">require('../lib/swiper.min.css');</span><br><span class="line">let Swiper = require('../lib/swiper.min.js');</span><br><span class="line">let jsonp = require('../util/jsonp.js');</span><br></pre></td></tr></tbody></table></div></figure>

<p>初始化</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getInitialState: function() {</span><br><span class="line">      return {</span><br><span class="line">      	imgUrls: [],</span><br><span class="line">      };</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></div></figure>

<p>获取数据<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jianshu.com/p/a883552c67de">关于this.setState()的那些事</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount: function() {</span><br><span class="line">	// 这里的格式，看jsonp是如何编写的。</span><br><span class="line">		jsonp(this.props.source, "", "callback", (data) =&gt; {</span><br><span class="line">			</span><br><span class="line">			if(data.status) {</span><br><span class="line">				//如果组件渲染到了 DOM 中，isMounted() 返回 true。</span><br><span class="line">				//可以使用该方法保证 setState() 和 forceUpdate() </span><br><span class="line">				//在异步场景下的调用不会出错。</span><br><span class="line">				</span><br><span class="line">				// 保证渲染了。</span><br><span class="line">				if(this.isMounted()) {</span><br><span class="line">					this.setState({ // 设置state。。</span><br><span class="line">						imgUrls: data.data,</span><br><span class="line">					})</span><br><span class="line">					// 再这里创建swiper？？？</span><br><span class="line">				    new Swiper ('#header .swiper-container', {</span><br><span class="line">					    loop: true,</span><br><span class="line">					    pagination: '.swiper-pagination',</span><br><span class="line">					    paginationClickable: true,</span><br><span class="line">					    autoplay : 3000,</span><br><span class="line">						autoplayDisableOnInteraction : false,		    </span><br><span class="line">					}) </span><br><span class="line">				}	</span><br><span class="line">			}else {</span><br><span class="line">				alert(data.msg);</span><br><span class="line">			}</span><br><span class="line">		}); </span><br><span class="line">	},</span><br></pre></td></tr></tbody></table></div></figure>

<p>render()</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">render: function () {</span><br><span class="line">	let countId = 0; // key</span><br><span class="line">		return (</span><br><span class="line">			&lt;div id="header"&gt;</span><br><span class="line">			  &lt;div className="swiper-container"&gt; // 使用swiper组件</span><br><span class="line">					&lt;div className="swiper-wrapper"&gt;</span><br><span class="line">						{</span><br><span class="line">							this.state.imgUrls.map((url) =&gt; { // 用map循环渲染节点 - 数据来源jsonp获取</span><br><span class="line">							return &lt;div className="swiper-slide" key={"header" + countId++} &gt;</span><br><span class="line">											&lt;img className="img" src={url} /&gt;</span><br><span class="line">										&lt;/div&gt;</span><br><span class="line">							})</span><br><span class="line">						}</span><br><span class="line">					&lt;/div&gt;</span><br><span class="line">					&lt;div className="swiper-pagination"&gt;&lt;/div&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">		);</span><br><span class="line">	}</span><br></pre></td></tr></tbody></table></div></figure>


        <h3 id="otherapp-jsx">
          <a href="#otherapp-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#otherapp-jsx" class="headerlink" title="otherapp.jsx"></a>otherapp.jsx</h3>
      <p><img src="https://s3.bmp.ovh/imgs/2022/02/9415caec77668c47.jpg" alt="03"></p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">render: function() {</span><br><span class="line">let countId = 0;</span><br><span class="line">return (</span><br><span class="line">	&lt;div className="oapp"&gt;</span><br><span class="line">		&lt;ul&gt;</span><br><span class="line">			{</span><br><span class="line">				// apps - state - jsonp获取。</span><br><span class="line">				this.state.apps.map((app) =&gt; { 	// 遍历 - 添加 li节点</span><br><span class="line">					return &lt;li key={ "otherapp" + countId++ }&gt;</span><br><span class="line">										&lt;a href={ app.url }&gt; // 跳转 - 官网。。。。</span><br><span class="line">											&lt;div className="app_icon"&gt; // 包裹img</span><br><span class="line">												&lt;img src={ app.icon } alt=""/&gt;</span><br><span class="line">											&lt;/div&gt;</span><br><span class="line">											&lt;span&gt;{ app.title }&lt;/span&gt;</span><br><span class="line">										&lt;/a&gt;</span><br><span class="line">									&lt;/li&gt;</span><br><span class="line">				})</span><br><span class="line">			}</span><br><span class="line">		&lt;/ul&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></div></figure>


        <h3 id="spike-jsx">
          <a href="#spike-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#spike-jsx" class="headerlink" title="spike.jsx"></a>spike.jsx</h3>
      <p>秒杀设置。时间滚动。</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34645412/article/details/81170576">ES6 Promise用法小结</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>promise 写的很好！</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">	&lt;span&gt;{this.state.hour}&lt;/span&gt;:&lt;span&gt;{this.state.minutes}&lt;/span&gt;:&lt;span&gt;{this.state.second}&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">	</span><br><span class="line">	// 初始化</span><br><span class="line">	getInitialState: function() {</span><br><span class="line">		return {</span><br><span class="line">			hour: "00",</span><br><span class="line">			minutes: "00",</span><br><span class="line">			second: "00",</span><br><span class="line">			stores: [],</span><br><span class="line">			more: "" // 跳转链接。。</span><br><span class="line">		}</span><br><span class="line">	},</span><br><span class="line"></span><br><span class="line">	formatTime: function(times=0) { // 格式化</span><br><span class="line">		times = +times;</span><br><span class="line">		let hour = 0,</span><br><span class="line">			minutes = 0,</span><br><span class="line">			second = 0,</span><br><span class="line">			regTwo = /^\d{2}$/,</span><br><span class="line">			regInteger = /^(\d{1,2})\.?\d*$/;</span><br><span class="line">			</span><br><span class="line">		if(times/3600 &gt;= 1) {</span><br><span class="line">			hour = times/3600;</span><br><span class="line">			hour = +regInteger.exec(hour.toString())[1] </span><br><span class="line">			times -= hour*3600; </span><br><span class="line">			hour = regTwo.test(hour.toString()) ? hour.toString() : `0${hour}`;</span><br><span class="line">		}</span><br><span class="line">		if(times/60 &gt;= 1) {</span><br><span class="line">			minutes = times/60;</span><br><span class="line">			minutes = +regInteger.exec(minutes.toString())[1] </span><br><span class="line">			times -= minutes*60; </span><br><span class="line">			minutes = regTwo.test(minutes.toString()) ? minutes.toString() : `0${minutes}`;</span><br><span class="line">		}</span><br><span class="line">		second = times;</span><br><span class="line">		second = regTwo.test(second.toString()) ? second.toString() : `0${second}`;</span><br><span class="line">		return {</span><br><span class="line">			hour: hour,</span><br><span class="line">			minutes: minutes,</span><br><span class="line">			second: second,</span><br><span class="line">		}</span><br><span class="line">	},</span><br><span class="line">	</span><br><span class="line">	componentDidMount: function() {	// 加载完，调用getData -&gt; promise</span><br><span class="line">		let getData = () =&gt; {</span><br><span class="line">			let promise = new Promise((resolve, reject) =&gt; {</span><br><span class="line">				</span><br><span class="line">				jsonp(this.props.source, "", "callback", (data) =&gt; {</span><br><span class="line">					if(data.status) {</span><br><span class="line">						if(this.isMounted()) {</span><br><span class="line">							this.setState({</span><br><span class="line">								stores: data.data,</span><br><span class="line">								more: data.more,</span><br><span class="line">							});</span><br><span class="line">							resolve(data.times); // 成功</span><br><span class="line">						}</span><br><span class="line">					}else {</span><br><span class="line">						alert(data.msg);</span><br><span class="line">						reject("get data error!") // 失败</span><br><span class="line">					}</span><br><span class="line">				})</span><br><span class="line">			})</span><br><span class="line">			return promise; // 得到了一个Promise对象,可以使用then、catch方法了。</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		getData().then((times) =&gt; {// then 接收resolve返回的数据</span><br><span class="line">			times = +times;</span><br><span class="line">			let timer = window.setInterval(() =&gt; { // 定时器。</span><br><span class="line">				let {hour, minutes, second} = this.formatTime(times--); // 解构赋值</span><br><span class="line">				if(times == -1) {</span><br><span class="line">					clearInterval(timer); // 关闭定时器。</span><br><span class="line">					timer = null;</span><br><span class="line">				}</span><br><span class="line">				this.setState({ // 设置state。可以到组件输出了</span><br><span class="line">					hour: hour,</span><br><span class="line">					minutes: minutes,</span><br><span class="line">					second: second,</span><br><span class="line">				});</span><br><span class="line">			}, 1000); // 1秒</span><br><span class="line">		}, (err) =&gt; {</span><br><span class="line">			alert(err);</span><br><span class="line">		});</span><br><span class="line">		</span><br><span class="line">	},</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>


        <h3 id="more-jsx">
          <a href="#more-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#more-jsx" class="headerlink" title="more.jsx"></a>more.jsx</h3>
      <p>主要是展示图片<br>初始化三个放图片的数组 - 图片的链接 - 可以加载资源。<br>通过jsonp获取。</p>
<p>render() 通过map循环渲染出来。。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount: function() { // 这个生命周期获取数据。</span><br><span class="line">	jsonp(this.props.source, "", "callback", (data) =&gt; {</span><br><span class="line">		if(data.status) {</span><br><span class="line">			if(this.isMounted()) {</span><br><span class="line">				this.setState({</span><br><span class="line">					more1: data.data.slice(0,3), // 写入。</span><br><span class="line">					more2: data.data.slice(3,5),</span><br><span class="line">					more3: data.data.slice(5,7),</span><br><span class="line">				})</span><br><span class="line">			    new Swiper ('.more_bottom .swiper-container', { // 实例对象</span><br><span class="line">				    loop: true,</span><br><span class="line">				    pagination: '.swiper-pagination',</span><br><span class="line">				    paginationClickable: true,</span><br><span class="line">				    autoplay : 2000,</span><br><span class="line">					autoplayDisableOnInteraction : false,		    </span><br><span class="line">				}) </span><br><span class="line">			}</span><br><span class="line">		}else {</span><br><span class="line">			alert(data.msg);</span><br><span class="line">		}</span><br><span class="line">	});</span><br><span class="line">},</span><br><span class="line"></span><br><span class="line">&lt;div className="more_bottom"&gt;</span><br><span class="line">	&lt;div className="swiper-container"&gt;</span><br><span class="line">		&lt;div className="swiper-wrapper"&gt;</span><br><span class="line">			{</span><br><span class="line">				this.state.more3.map((item) =&gt; {</span><br><span class="line">					return  &lt;div className="swiper-slide" key={"more" + countId++}&gt;</span><br><span class="line">								&lt;a href={item.url}&gt;</span><br><span class="line">									&lt;img src={item.icon} alt=""/&gt;</span><br><span class="line">								&lt;/a&gt;</span><br><span class="line">							&lt;/div&gt;</span><br><span class="line">				})</span><br><span class="line">			}</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">		&lt;div className="swiper-pagination"&gt;&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></tbody></table></div></figure>


        <h3 id="like-jsx">
          <a href="#like-jsx" class="heading-link"><i class="fas fa-link"></i></a><a href="#like-jsx" class="headerlink" title="like.jsx"></a>like.jsx</h3>
      <p>同上。</p>

        <h2 id="Node文件系统">
          <a href="#Node文件系统" class="heading-link"><i class="fas fa-link"></i></a><a href="#Node文件系统" class="headerlink" title="Node文件系统"></a>Node文件系统</h2>
      <p>这里用node构建的。学习node！</p>
<p>再server中的主要文件<br>public</p>
<ul>
<li>database - 编写文字信息 - json</li>
<li>images - 图片信息 - 注意命名 like1.jpg</li>
</ul>
<p>routes</p>
<ul>
<li>data.js - 根据路由信息<strong>传递数据</strong></li>
</ul>
<p>app.js - 开启服务</p>

        <h3 id="理论学习">
          <a href="#理论学习" class="heading-link"><i class="fas fa-link"></i></a><a href="#理论学习" class="headerlink" title="理论学习"></a>理论学习</h3>
      <p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.runoob.com/nodejs/nodejs-express-framework.html">Node.js Express 框架</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://expressjs.com/en/4x/api.html">Express官网</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>Express 框架核心特性：</p>
<ul>
<li>可以设置中间件来响应 HTTP 请求。</li>
<li>定义了路由表用于执行不同的 HTTP 请求动作。</li>
<li>可以通过向模板传递参数来动态渲染 HTML 页面。</li>
</ul>
<p>与 express 框架一起安装的</p>
<ul>
<li>cnpm install body-parser –save - 有</li>
<li>cnpm install cookie-parser –save - 有</li>
<li>cnpm install multer –save</li>
</ul>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">body-parser - node.js 中间件，用于处理 JSON, Raw, Text 和 URL 编码的数据。</span><br><span class="line">cookie-parser - 这就是一个解析Cookie的工具。通过req.cookies可以取到传过来的cookie，并把它们转成对象。</span><br><span class="line">multer - node.js 中间件，用于处理 enctype="multipart/form-data"（设置表单的MIME编码）的表单数据。</span><br></pre></td></tr></tbody></table></div></figure>

<p>app.set(name, value) - 存储数据</p>
<blockquote>
<p>Assigns setting name to value. You may store any value that you want,<br>but certain names can be used to configure the behavior of the server.<br>These special names are listed in the app settings table.</p>
</blockquote>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 例子</span><br><span class="line">app.set('title', 'My Site')</span><br><span class="line">app.get('title') // "My Site"</span><br><span class="line"></span><br><span class="line">// view engine setup - 案例源码</span><br><span class="line">app.set('views', path.join(__dirname, 'views')); //？？？</span><br><span class="line">app.set('view engine', 'ejs'); // //识别ejs代码 // 屏蔽也没事。。</span><br></pre></td></tr></tbody></table></div></figure>

<p>app.use([path,] callback [, callback…]) - 调用回调函数。。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// path - 例子</span><br><span class="line">//This will match paths starting with /abcd:</span><br><span class="line">app.use('/abcd', function (req, res, next) {</span><br><span class="line">  next()</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">//This will match paths starting with /abcd, /abxcd, /abFOOcd, /abbArcd, and so on:</span><br><span class="line">app.use('/ab*cd', function (req, res, next) {</span><br><span class="line">  next()</span><br><span class="line">})</span><br><span class="line">--------------------------------------------</span><br><span class="line">// callback - 例子</span><br><span class="line">var r1 = express.Router()</span><br><span class="line">r1.get('/', function (req, res, next) {</span><br><span class="line">  next()</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">var r2 = express.Router()</span><br><span class="line">r2.get('/', function (req, res, next) {</span><br><span class="line">  next()</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">app.use(r1, r2)</span><br></pre></td></tr></tbody></table></div></figure>


<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/jokerjason/p/7815040.html">Node.js 模块之 morgan中间件记录日志</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var logger = require('morgan');</span><br><span class="line">var app = express();</span><br><span class="line">app.use(logger('dev'));</span><br></pre></td></tr></tbody></table></div></figure>

<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jianshu.com/p/cd3de110b4b6">Express中间件body-parser</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>使用这个模块可以解析JSON、Raw、文本、URL-encoded格式的请求体</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jianshu.com/p/7fc30d77cc5c">cookie-parser中间件的使用</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jianshu.com/p/488f61406c65">express 中间件cookie-parser</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>作用：解析和设置cookie</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const cookieParser = require('cookie-parser');</span><br><span class="line">app.use(cookieParser('123456')); //使用cookie中间件，传入签名123456进行加密</span><br></pre></td></tr></tbody></table></div></figure>


<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/mimikuer/article/details/78919349">express框架中的express.static()和app.use()</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<blockquote>
<p>可以理解成，对于不同的用户来说，内容都不会变化的文件。因为不管是张三李四访问百度，<br>他们所接收到的看到的图片、css文件和前端javascript文件都是一样的，我们称这类文件为静态资源文件。<br>而对于后台开发人员来说，就是前端开发完静态页面之后给到的css、images、js等文件，这些一般放在public文件夹下面的。</p>
</blockquote>
<p>app.use是用来给path注册中间函数的 - 有点懂。。</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/mimikuer/article/details/78871187">关于nodejs中的回调函数理解</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<blockquote>
<p>Node的三个特点：单线程，非阻塞I/O，事件驱动。Node的编程思维就是，所有的都是异步的，因此有了大量的回调函数。<br>回调函数，就是放在另外一个函数（如 parent）的参数列表中，作为参数传递给这个 parent，然后在 parent 函数体的某个位置执行。<br>正确的做法是，在getAllAlbums中使用callback回调函数，而在调用getAllAlbums时，把读完文件后的 数据 当做回调函数的 参数 来使用：</p>
</blockquote>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.runoob.com/nodejs/nodejs-utitlity-module.html">Node.js 工具模块</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<ul>
<li>OS 模块 - 提供基本的系统操作函数。</li>
<li>Path 模块 - 提供了处理和转换文件路径的工具。</li>
<li>Net 模块 - 用于底层的网络通信。提供了服务端和客户端的的操作。</li>
<li>DNS 模块 - 用于解析域名。</li>
<li>Domain 模块 - 简化异步代码的异常处理，可以捕捉处理try catch无法捕捉的。</li>
</ul>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.runoob.com/nodejs/nodejs-path-module.html">Node.js Path 模块</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>Node.js path 模块提供了一些用于处理文件路径的小工具，我们可以通过以下方式引入该模块：<br><code>var path = require("path")</code></p>
<p>path.join([path1][, path2][, …])<br>用于连接路径。该方法的主要用途在于，会正确使用当前系统的路径分隔符，Unix系统是”/“，Windows系统是”"。</p>

        <h3 id="app-js">
          <a href="#app-js" class="heading-link"><i class="fas fa-link"></i></a><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h3>
      <p>引入资源</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var express = require('express'); // 请求</span><br><span class="line">var path = require('path');</span><br><span class="line">var favicon = require('serve-favicon');</span><br><span class="line">var logger = require('morgan'); // morgan中间件记录日志</span><br><span class="line">var cookieParser = require('cookie-parser'); // </span><br><span class="line">var bodyParser = require('body-parser'); // 解析数据</span><br><span class="line"></span><br><span class="line">var data = require('./routes/data'); // 传递数据</span><br><span class="line"></span><br><span class="line">var app = express();// 启动</span><br></pre></td></tr></tbody></table></div></figure>


<p>请求数据</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//使用app.use(logger('dev'));可以将请求信息打印在控制台，便于开发调试，</span><br><span class="line">//但实际生产环境中，需要将日志记录在log文件里</span><br><span class="line">app.use(logger('dev'));</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.json()); //获取JSON编码的请求体</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded({ extended: false })); // 获取URL编码的请求体</span><br><span class="line"></span><br><span class="line">app.use(cookieParser()); // 不加密。</span><br><span class="line"></span><br><span class="line">app.use(express.static(path.join(__dirname, 'public'))); // 静态资源路径</span><br><span class="line"></span><br><span class="line">app.use("/data/swiper", data.swiper); // 到当前路径，执行方法，调用数据，传递数据</span><br><span class="line">app.use("/data/otherapp", data.otherapp);</span><br><span class="line">app.use("/data/spike", data.spike);</span><br><span class="line">app.use("/data/more", data.more);</span><br><span class="line">app.use("/data/like", data.like);</span><br></pre></td></tr></tbody></table></div></figure>

<p>处理错误<br>这是怎么触发的？？？？</p>
<p>关闭服务</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle.js:formatted:32914 GET http://localhost:3000/data/swiper?callback=window.jsonp.cb0 net::ERR_CONNECTION_REFUSED</span><br></pre></td></tr></tbody></table></div></figure>

<p>触发500<br>屏蔽// app.use(“/data/swiper”, data.swiper); - 然后重启<br>app.use(“/data/swiper12313”, data.swiper); - 输入错误地址 - 500<br>app.use(“/data/swiper”, data.swiperaaa); - 输入错误接口 - 运行不了。。</p>
<p>404在哪里。。。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// catch 404 and forward to error handler</span><br><span class="line">app.use(function(req, res, next) {</span><br><span class="line">  var err = new Error('Not Found');</span><br><span class="line">  err.status = 404;</span><br><span class="line">  next(err);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">// error handlers</span><br><span class="line"></span><br><span class="line">// development error handler</span><br><span class="line">// will print stacktrace</span><br><span class="line">if (app.get('env') === 'development') {</span><br><span class="line">  app.use(function(err, req, res, next) {</span><br><span class="line">    res.status(err.status || 500);</span><br><span class="line">    res.render('error', {</span><br><span class="line">      message: err.message,</span><br><span class="line">      error: err</span><br><span class="line">    });</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// production error handler</span><br><span class="line">// no stacktraces leaked to user</span><br><span class="line">app.use(function(err, req, res, next) {</span><br><span class="line">  res.status(err.status || 500);</span><br><span class="line">  res.render('error', {</span><br><span class="line">    message: err.message,</span><br><span class="line">    error: {}</span><br><span class="line">  });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></div></figure>



        <h3 id="data-js">
          <a href="#data-js" class="heading-link"><i class="fas fa-link"></i></a><a href="#data-js" class="headerlink" title="data.js"></a>data.js</h3>
      <p>引入资源</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let express = require('express');</span><br><span class="line">let router = express.Router();</span><br><span class="line">let fs = require('fs');</span><br></pre></td></tr></tbody></table></div></figure>


<p>读取文件<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.runoob.com/nodejs/nodejs-fs.html">Node.js 文件系统</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<blockquote>
<p>Node.js 文件系统（fs 模块）模块中的方法均有异步和同步版本，<br>例如读取文件内容的函数有异步的 fs.readFile() 和同步的 fs.readFileSync()。</p>
</blockquote>
<p>获取json的文字信息</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">let dataBase = null;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 通过Promise读取存储的数据,确保有数据后再执行其他操作</span><br><span class="line"> * @return {null} [无]</span><br><span class="line"> */</span><br><span class="line">let readFileData = () =&gt; {</span><br><span class="line">	let promise = new Promise((resolve, reject) =&gt; { // 异步，有数据，再进行</span><br><span class="line">		fs.readFile("./public/database/database.json", "utf-8", (err, data) =&gt; { // // 异步读取</span><br><span class="line">			if(err) {</span><br><span class="line">				console.log(err);</span><br><span class="line">				reject("read filedata error!");</span><br><span class="line">			}else {</span><br><span class="line">				data = JSON.parse(data); // 解析json</span><br><span class="line">				dataBase = data; // 接收数据</span><br><span class="line">				resolve();</span><br><span class="line">			}</span><br><span class="line">		})</span><br><span class="line">	});</span><br><span class="line">	return promise; // 返回promise，可以用then ， catch</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure>

<p>获取文件名<br>读取目录的语法格式：<br><code>fs.readdir(path, callback)</code></p>
<p>获取图片信息，图片根据文件夹命名。<br>server路径下</p>
<ul>
<li>public<ul>
<li>database - database.json</li>
<li>images<ul>
<li>like - like1.jpg</li>
<li>more - more1.jps</li>
<li>otherapp</li>
<li>spike</li>
<li>swiper</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 通过Promise获取文件名</span><br><span class="line"> * @param  {String} path      [文件的路径名]</span><br><span class="line"> * @param  {String} fileClass [文件所属的种类,用于区别请求]</span><br><span class="line"> * @return {null} [无] </span><br><span class="line"> */</span><br><span class="line">let getFileName = (path, fileClass) =&gt; {</span><br><span class="line">	let promise = new Promise((resolve, reject) =&gt; {</span><br><span class="line">		fs.readdir(path, (err, files) =&gt; {  </span><br><span class="line">	        if (err) {  </span><br><span class="line">	            reject("read fileName err!")</span><br><span class="line">	        } else {  </span><br><span class="line">	        	files = files.map((file) =&gt; { // 获取名字。后端可请求的路径</span><br><span class="line">	        		return "http://localhost:3000/images/" + fileClass + "/" + file;</span><br><span class="line">	        	});</span><br><span class="line">	        	resolve(files);</span><br><span class="line">	        }         </span><br><span class="line">	    }); </span><br><span class="line">	});</span><br><span class="line">	return promise;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure>

<p>请求资源<br>.then 异步体现出来了</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">let imgNames = [];</span><br><span class="line">let appNames = [];</span><br><span class="line">let spikeNames = [];</span><br><span class="line">let moreNames = [];</span><br><span class="line">let likeNames = [];</span><br><span class="line"></span><br><span class="line">// 获取完json - 文字信息后</span><br><span class="line">readFileData().then(() =&gt; {</span><br><span class="line">	// 获取图片资源 - 返回图片链接数组 - 可请求到了</span><br><span class="line">	getFileName("./public/images/swiper", "swiper").then((files) =&gt; {</span><br><span class="line">		imgNames = files;</span><br><span class="line">	},() =&gt; {</span><br><span class="line">		console.log(err);</span><br><span class="line">		imgNames = false;</span><br><span class="line">	});</span><br><span class="line"></span><br><span class="line">	getFileName("./public/images/otherapp", "otherapp").then((files) =&gt; {</span><br><span class="line">		let obj = dataBase.otherapp;</span><br><span class="line">		appNames = files.map((file, index) =&gt; {</span><br><span class="line">			obj[index].icon = file;</span><br><span class="line">			return obj[index];</span><br><span class="line">		});</span><br><span class="line">	},() =&gt; {</span><br><span class="line">		console.log(err);</span><br><span class="line">	});</span><br><span class="line"></span><br><span class="line">	getFileName("./public/images/spike", "spike").then((files) =&gt; {</span><br><span class="line">		let obj = dataBase.spike.store;</span><br><span class="line">		spikeNames = files.map((file, index) =&gt; {</span><br><span class="line">			obj[index].icon = file;		</span><br><span class="line">			return obj[index];</span><br><span class="line">		});</span><br><span class="line">	},() =&gt; {</span><br><span class="line">		console.log(err);</span><br><span class="line">	})</span><br><span class="line"></span><br><span class="line">	getFileName("./public/images/more", "more").then((files) =&gt; {</span><br><span class="line">		moreNames = files.map((file, index) =&gt; {</span><br><span class="line">			return {</span><br><span class="line">				icon: file,</span><br><span class="line">				url: dataBase.more[index],</span><br><span class="line">			}</span><br><span class="line">		});</span><br><span class="line">	},() =&gt; {</span><br><span class="line">		console.log(err);</span><br><span class="line">	})</span><br><span class="line"></span><br><span class="line">	getFileName("./public/images/like", "like").then((files) =&gt; {</span><br><span class="line">		let obj = dataBase.like;</span><br><span class="line">		likeNames = files.map((file, index) =&gt; {</span><br><span class="line">			obj[index].icon = file;</span><br><span class="line">			return obj[index];</span><br><span class="line">		})</span><br><span class="line">	},() =&gt; {</span><br><span class="line">		console.log(err);</span><br><span class="line">	})</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}, (err) =&gt; {</span><br><span class="line">	console.log(err);</span><br><span class="line">})</span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>


<p>写入页面<br>当app.js进入页面，执行data中的方法，上面已经获取到数据，如果有请求发生，返回数据。<br>请求 - jsonp</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/02/1cd8f777d5d14592.jpg"></p>
<p><code>res.send()：传送HTTP响应</code> - 返回数据</p>
<p>如果 exec() 找到了匹配的文本，则返回一个结果数组。否则，返回 null。</p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">exports.swiper = (req, res) =&gt; {</span><br><span class="line">	let reg = /\?callback=(.*)/;</span><br><span class="line">	let callback = reg.exec(req.url)[1];</span><br><span class="line">	const sendData = { // 定义数据结构</span><br><span class="line">		status: 0,</span><br><span class="line">		msg: "",</span><br><span class="line">		data: "",</span><br><span class="line">	}</span><br><span class="line">	if(imgNames) { // 如果不为空</span><br><span class="line">		sendData.status = 1;</span><br><span class="line">		sendData.msg = "success"; // 标记</span><br><span class="line">		sendData.data = imgNames; // 写入数据。</span><br><span class="line">	}else {</span><br><span class="line">		sendData.msg = "error";</span><br><span class="line">	}</span><br><span class="line">	let json = JSON.stringify(sendData);</span><br><span class="line">  	res.send(callback + '(' + json + ')'); // 发送</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></div></figure>



        <h3 id="database-json">
          <a href="#database-json" class="heading-link"><i class="fas fa-link"></i></a><a href="#database-json" class="headerlink" title="database.json"></a>database.json</h3>
      <p>熟悉一下json的编写<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42614253/article/details/82766488">JSON书写格式</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">	“otherapp”: [</span><br><span class="line">		{</span><br><span class="line">			"title": "京东",</span><br><span class="line">			"url": "http://"</span><br><span class="line">		},</span><br><span class="line">		{</span><br><span class="line">			"title": "京东",</span><br><span class="line">			"url": "http://"</span><br><span class="line">		}</span><br><span class="line">	],</span><br><span class="line">	"spike": [</span><br><span class="line">		{</span><br><span class="line">			"store": [</span><br><span class="line">				{</span><br><span class="line">					"url": "http://",</span><br><span class="line">					"sprice": 299,</span><br><span class="line">					"price": 399</span><br><span class="line">				},</span><br><span class="line">				{</span><br><span class="line">					"url": "http://",</span><br><span class="line">					"sprice": 3999,</span><br><span class="line">					"price": 4999</span><br><span class="line">				}</span><br><span class="line">			]</span><br><span class="line">		}</span><br><span class="line">	],</span><br><span class="line">	"like": [</span><br><span class="line">		{</span><br><span class="line">			"url": "http://",</span><br><span class="line">			"desc": "开心",</span><br><span class="line">			"price": 99.00,</span><br><span class="line">			"more": "http://"</span><br><span class="line">		}</span><br><span class="line">	]</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></div></figure>


        <h2 id="总结-1">
          <a href="#总结-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2>
      <p>很好的项目，了解了React编写页面的方式，学习了Node的一些操作。</p>
<p>收获：<br>了解了在React中组件划分，获取数据的方式。第一个学习制作React的简易过程中学到的思路，在学习项目的时候，很有帮助。<br>想到的就是，在什么时候运行，什么时候获取数据。编程是给人的，数据是给机器的。</p>
<p>Jsonp用于请求，node用于相应请求。</p>
<p>Node初步学习，感受是提供数据，把资源分门别类的放好，统一提供接口返回数据。方便文字，图片等资源的获取。</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://example.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="post-share"><div class="social-share" data-sites="qzone, qq, weibo, wechat, douban, linkedin, facebook, twitter, google">Share to: </div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2022/02/02/%E5%89%8D%E7%AB%AF%E9%9D%A2%E7%BB%8F%E6%B1%87%E6%80%BB/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">前端面经汇总</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2022/02/02/React%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="paginator-prev__text">React学习笔记</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#build-your-own-react"><span class="toc-number">1.</span> <span class="toc-text">
          build-your-own-react</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-number">1.1.</span> <span class="toc-text">
          开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-The-createElement-Function"><span class="toc-number">1.2.</span> <span class="toc-text">
          1.The createElement Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-The-render-Function"><span class="toc-number">1.3.</span> <span class="toc-text">
          2.The render Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Concurrent-Mode"><span class="toc-number">1.4.</span> <span class="toc-text">
          3. Concurrent Mode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Fibers"><span class="toc-number">1.5.</span> <span class="toc-text">
          4. Fibers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Render-and-Commit-Phases"><span class="toc-number">1.6.</span> <span class="toc-text">
          5. Render and Commit Phases</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Reconciliation"><span class="toc-number">1.7.</span> <span class="toc-text">
          6. Reconciliation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Function-Components"><span class="toc-number">1.8.</span> <span class="toc-text">
          7. Function Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Hooks"><span class="toc-number">1.9.</span> <span class="toc-text">
          8. Hooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.10.</span> <span class="toc-text">
          总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE01-JD%E9%A6%96%E9%A1%B5"><span class="toc-number">2.</span> <span class="toc-text">
          项目01-JD首页</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">
          遇到问题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%80%9D%E8%B7%AF"><span class="toc-number">2.2.</span> <span class="toc-text">
          整体思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80"><span class="toc-number">2.3.</span> <span class="toc-text">
          页面布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%BC%96%E5%86%99"><span class="toc-number">2.4.</span> <span class="toc-text">
          组件编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#search-jsx"><span class="toc-number">2.4.1.</span> <span class="toc-text">
          search.jsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#header-jsx"><span class="toc-number">2.4.2.</span> <span class="toc-text">
          header.jsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#otherapp-jsx"><span class="toc-number">2.4.3.</span> <span class="toc-text">
          otherapp.jsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spike-jsx"><span class="toc-number">2.4.4.</span> <span class="toc-text">
          spike.jsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#more-jsx"><span class="toc-number">2.4.5.</span> <span class="toc-text">
          more.jsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#like-jsx"><span class="toc-number">2.4.6.</span> <span class="toc-text">
          like.jsx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Node%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.5.</span> <span class="toc-text">
          Node文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%90%86%E8%AE%BA%E5%AD%A6%E4%B9%A0"><span class="toc-number">2.5.1.</span> <span class="toc-text">
          理论学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-js"><span class="toc-number">2.5.2.</span> <span class="toc-text">
          app.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-js"><span class="toc-number">2.5.3.</span> <span class="toc-text">
          data.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#database-json"><span class="toc-number">2.5.4.</span> <span class="toc-text">
          database.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">2.6.</span> <span class="toc-text">
          总结</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/header.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">LJY_BLOG</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">31</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">4</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>